---
description: SOLID 원칙과 TDD 강제 규칙. 유지보수 가능한 소프트웨어 설계를 위한 레퍼런스. 코드 품질 분석, 리팩토링 계획, 아키텍처 검증 시 참조.
name: solid-design-rules
---
# SOLID Design Rules

## 핵심 원칙

**변경 격리를 위한 설계.**
무엇이 변경될지 예측하고, 그 변경의 전파 범위를 엄격히 제한하라.

---

## 1. 단일 책임 원칙 (SRP)

모든 클래스, 모듈, 함수는 **정확히 하나의 변경 이유**만 가져야 한다.

**금지:**
- 비즈니스 규칙, 데이터 영속성, 포맷팅을 하나의 클래스에 혼합
- 관련 없는 관심사를 조율하는 "God" 서비스
- 20줄 이상의 메서드
- 5개 이상의 의존성을 가진 클래스

**필수:**
- 정책, 오케스트레이션, 실행의 명시적 분리
- 작고, 의도가 명확한 컴포넌트

---

## 2. 개방-폐쇄 원칙 (OCP)

시스템은 **확장에는 열려 있고, 수정에는 닫혀 있어야** 한다.

**금지:**
- 타입이나 enum 증가에 따른 `if/switch` 체인
- 핵심 로직에 내장된 기능 플래그
- 동작을 분기하는 boolean 파라미터

**필수:**
- 인터페이스 기반 확장성
- 전략 패턴과 다형적 디스패치

---

## 3. 리스코프 치환 원칙 (LSP)

서브타입은 기본 타입으로 **완전히 대체 가능**해야 한다.

**금지:**
- 서브클래스에서 빈 메서드 구현
- 호출 코드에서 `instanceof` 체크
- 서브클래스에서 사전 조건 강화
- 예상치 못한 예외 던지기

**필수:**
- 모든 구현에서 동작 계약 유지

---

## 4. 인터페이스 분리 원칙 (ISP)

인터페이스는 **클라이언트 관점**에서 설계되어야 한다.

**금지:**
- 5개 이상의 메서드를 가진 인터페이스
- 구현체가 사용하지 않는 메서드에 의존하도록 강제

**필수:**
- 역할별 최소 인터페이스
- 명령과 쿼리의 분리

---

## 5. 의존성 역전 원칙 (DIP)

상위 레벨 비즈니스 로직은 **하위 레벨 세부사항에 의존하면 안 된다**.

**금지:**
- 비즈니스 로직에서 인프라 클래스에 `new` 키워드 사용
- 도메인 서비스에서 직접적인 DB/HTTP 클라이언트 사용
- 도메인 엔티티에 프레임워크 어노테이션

**필수:**
- 생성자 기반 의존성 주입
- 비즈니스 레이어가 소유하는 인터페이스

---

## 6. TDD 규칙

### 구현 전 테스트

1. 실패하는 테스트 시나리오를 먼저 정의
2. 테스트를 만족시키기 위한 구현만 작성
3. 테스트 통과 후에만 리팩토링

### 설계 위반 신호

| 신호 | 위반 |
|------|------|
| 과도한 모킹 | SRP 위반 |
| private 메서드 테스트 필요 | 잘못된 경계 |
| 단위 테스트에 DB/네트워크 필요 | DIP 위반 |

---

## 7. Repository 패턴

**Repository = 컬렉션 추상화, 영속성 메커니즘이 아님**

**금지:**
- 인터페이스에 SQL/쿼리 언어
- 메서드 이름에 인프라 용어

**필수:**
- 도메인 중심 연산 (`find`, `save`, `exists`)
- 테스트를 위해 인메모리 구현으로 대체 가능해야 함
